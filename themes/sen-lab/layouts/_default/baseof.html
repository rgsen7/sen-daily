<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} â€” {{ .Site.Title }}{{ end }}</title>
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  
  <meta property="og:title" content="{{ .Title }}">
  <meta property="og:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  {{ with .Site.Params.images }}<meta property="og:image" content="{{ index . 0 | absURL }}">{{ end }}

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: ['selector', '[data-theme="dark"]'],
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
            mono: ['JetBrains Mono', 'Fira Code', 'monospace']
          }
        }
      }
    }
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap');

    /* === PaperMod-style palette === */
    :root {
      --bg: #ffffff;
      --fg: #1e1e20;
      --fg-secondary: #6c6c6c;
      --entry: #ffffff;
      --border: #eee;
      --code-bg: #f5f5f5;
      --link: #1e1e20;
      --radius: 8px;
    }
    [data-theme="dark"] {
      --bg: #1d1e20;
      --fg: #dadadb;
      --fg-secondary: #9b9c9d;
      --entry: #2e2e33;
      --border: #333;
      --code-bg: #37383e;
      --link: #dadadb;
    }

    html { background: var(--bg); color: var(--fg-secondary); }
    ::selection { background: rgba(30,30,30,0.15); }
    [data-theme="dark"] ::selection { background: rgba(218,218,219,0.15); }

    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

    /* === Article content === */
    .article-content h2 { font-size: 1.4rem; font-weight: 700; margin: 2rem 0 0.75rem; color: var(--fg); }
    .article-content h3 { font-size: 1.15rem; font-weight: 700; margin: 1.75rem 0 0.5rem; color: var(--fg); }
    .article-content p { margin-bottom: 1rem; line-height: 1.8; font-size: 1rem; color: var(--fg-secondary); }
    .article-content ul { list-style: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
    .article-content li { margin-bottom: 0.5rem; line-height: 1.75; font-size: 1rem; color: var(--fg-secondary); }
    .article-content a { color: var(--fg); font-weight: 500; text-decoration: underline; text-underline-offset: 2px; }
    .article-content strong { color: var(--fg); font-weight: 700; }
    .article-content hr { border: none; border-top: 1px solid var(--border); margin: 2rem 0; }
    .article-content blockquote { border-left: 3px solid var(--border); padding: 0.5rem 1rem; margin: 1.25rem 0; color: var(--fg-secondary); }
    .article-content code { font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; background: var(--code-bg); padding: 0.15rem 0.4rem; border-radius: 4px; }
    .article-content pre { background: var(--code-bg); border-radius: var(--radius); padding: 1rem; overflow-x: auto; margin: 1.25rem 0; }
    .article-content pre code { background: none; padding: 0; }

    /* === Bento grid === */
    .bento { display: grid; gap: 12px; }
    @media (min-width: 768px) {
      .bento { grid-template-columns: repeat(3, 1fr); grid-template-rows: auto auto; }
      .bento-main { grid-column: 1 / 3; grid-row: 1 / 3; }
      .bento-side { grid-column: 3; }
    }
    .bento-card {
      background: var(--entry);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.25rem;
      transition: border-color 0.2s;
    }
    .bento-card:hover { border-color: var(--fg-secondary); }

    /* === Post entry (PaperMod style) === */
    .post-entry {
      background: var(--entry);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.25rem;
      margin-bottom: 12px;
      transition: transform 0.15s;
    }
    .post-entry:hover { transform: translateY(-2px); }

    /* === TOC === */
    #TableOfContents ul { list-style: none; padding-left: 0; }
    #TableOfContents li { margin-bottom: 0.4rem; }
    #TableOfContents a { color: var(--fg-secondary); text-decoration: none; font-size: 0.85rem; }
    #TableOfContents a:hover { color: var(--fg); }
    #TableOfContents ul ul { padding-left: 1rem; margin-top: 0.25rem; }

    .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
  </style>

  {{ partial "extend_head.html" . }}
  {{ range .AlternativeOutputFormats }}
  <link rel="{{ .Rel }}" type="{{ .MediaType.Type }}" href="{{ .Permalink | safeURL }}">
  {{ end }}
</head>
<body class="font-sans min-h-screen antialiased" style="background: var(--bg); color: var(--fg-secondary);">
  
  {{ partial "header.html" . }}
  
  <main class="max-w-3xl mx-auto px-4 sm:px-6 py-8">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}

  <script>
    const html = document.documentElement;
    const stored = localStorage.getItem('theme');
    if (stored === 'light') html.setAttribute('data-theme', 'light');
    else html.setAttribute('data-theme', 'dark');
    
    function toggleTheme() {
      const current = html.getAttribute('data-theme');
      const next = current === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
    }
  </script>
</body>
</html>
