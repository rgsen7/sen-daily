<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" class="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} — {{ .Site.Title }}{{ end }}</title>
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  
  {{/* OG */}}
  <meta property="og:title" content="{{ .Title }}">
  <meta property="og:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  {{ with .Site.Params.images }}<meta property="og:image" content="{{ index . 0 | absURL }}">{{ end }}

  {{/* Tailwind CSS via CDN */}}
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
            mono: ['JetBrains Mono', 'Fira Code', 'monospace']
          },
          maxWidth: {
            article: '720px'
          },
          borderRadius: {
            DEFAULT: '0.5rem'
          }
        }
      }
    }
  </script>

  {{/* Custom styles — oklch color system from shadcn/21st.dev */}}
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');

    /* === Theme Variables (shadcn/oklch) === */
    :root {
      --bg: oklch(0.99 0 0);
      --fg: oklch(0.145 0 0);
      --fg-muted: oklch(0.556 0 0);
      --card: oklch(1 0 0);
      --card-fg: oklch(0.145 0 0);
      --muted: oklch(0.97 0 0);
      --border: oklch(0.922 0 0);
      --primary: oklch(0.55 0.12 250);
      --primary-fg: oklch(0.99 0 0);
      --tag-bg: oklch(0.95 0.02 250);
      --tag-fg: oklch(0.4 0.08 250);
      --stat-up: oklch(0.65 0.18 145);
      --stat-down: oklch(0.65 0.18 25);
      --radius: 0.5rem;
    }
    .dark {
      --bg: oklch(0.12 0 0);
      --fg: oklch(0.95 0 0);
      --fg-muted: oklch(0.55 0 0);
      --card: oklch(0.17 0 0);
      --card-fg: oklch(0.95 0 0);
      --muted: oklch(0.22 0 0);
      --border: oklch(1 0 0 / 8%);
      --primary: oklch(0.7 0.12 250);
      --primary-fg: oklch(0.12 0 0);
      --tag-bg: oklch(0.2 0.02 250);
      --tag-fg: oklch(0.7 0.08 250);
    }

    /* === Base === */
    html { background: var(--bg); color: var(--fg-muted); }
    .dark html, html.dark { background: var(--bg); }
    ::selection { background: oklch(0.55 0.12 250 / 20%); }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

    /* === Utility classes === */
    .text-fg { color: var(--fg); }
    .text-fg-muted { color: var(--fg-muted); }
    .text-primary { color: var(--primary); }
    .bg-bg { background: var(--bg); }
    .bg-card { background: var(--card); }
    .bg-muted { background: var(--muted); }
    .border-theme { border-color: var(--border); }
    .bg-tag { background: var(--tag-bg); color: var(--tag-fg); }

    /* === Article content === */
    .article-content h2 { font-size: 1.25rem; font-weight: 600; margin-top: 2.5rem; margin-bottom: 1rem; color: var(--fg); }
    .article-content h3 { font-size: 1.1rem; font-weight: 600; margin-top: 2rem; margin-bottom: 0.75rem; color: var(--fg); }
    .article-content p { margin-bottom: 1rem; line-height: 1.75; }
    .article-content ul { list-style: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
    .article-content li { margin-bottom: 0.5rem; line-height: 1.7; }
    .article-content a { color: var(--primary); text-decoration: none; border-bottom: 1px solid transparent; transition: border-color 0.15s; }
    .article-content a:hover { border-bottom-color: var(--primary); }
    .article-content strong { color: var(--fg); font-weight: 600; }
    .article-content hr { border: none; border-top: 1px solid var(--border); margin: 2rem 0; }
    .article-content blockquote { border-left: 2px solid var(--primary); padding-left: 1rem; color: var(--fg-muted); margin: 1.5rem 0; }
    .article-content code { font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; background: var(--muted); padding: 0.15rem 0.4rem; border-radius: 3px; }
    .article-content pre { background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 1rem; overflow-x: auto; margin: 1.5rem 0; }
    .article-content pre code { background: none; padding: 0; }

    /* === Card component === */
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      transition: border-color 0.15s ease;
    }
    .card:hover { border-color: var(--fg-muted); }

    /* === Stat card === */
    .stat-value { font-size: 1.5rem; font-weight: 700; font-family: 'JetBrains Mono', monospace; color: var(--fg); }
    .stat-label { font-size: 0.75rem; color: var(--fg-muted); text-transform: uppercase; letter-spacing: 0.05em; }
    .stat-up { color: var(--stat-up); }
    .stat-down { color: var(--stat-down); }
  </style>

  {{ partial "extend_head.html" . }}
  
  {{/* RSS */}}
  {{ range .AlternativeOutputFormats }}
  <link rel="{{ .Rel }}" type="{{ .MediaType.Type }}" href="{{ .Permalink | safeURL }}">
  {{ end }}
</head>
<body class="bg-bg font-sans min-h-screen antialiased" style="color: var(--fg-muted)">
  
  {{ partial "header.html" . }}
  
  <main class="max-w-5xl mx-auto px-4 sm:px-6 py-8">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}

  {{/* Theme toggle */}}
  <script>
    const html = document.documentElement;
    const stored = localStorage.getItem('theme');
    if (stored === 'light') html.classList.remove('dark');
    else if (stored === 'dark' || !stored) html.classList.add('dark');
    
    function toggleTheme() {
      html.classList.toggle('dark');
      localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
    }
  </script>
</body>
</html>
