<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" class="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} â€” {{ .Site.Title }}{{ end }}</title>
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  
  {{/* OG */}}
  <meta property="og:title" content="{{ .Title }}">
  <meta property="og:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  {{ with .Site.Params.images }}<meta property="og:image" content="{{ index . 0 | absURL }}">{{ end }}

  {{/* Tailwind CSS via CDN */}}
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            bg: { DEFAULT: '#0a0a0a', light: '#fafafa' },
            fg: { DEFAULT: '#e5e5e5', muted: '#737373', light: '#171717' },
            accent: { DEFAULT: '#38bdf8', dim: '#0c4a6e' },
            border: { DEFAULT: 'rgba(255,255,255,0.06)' }
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
            mono: ['JetBrains Mono', 'Fira Code', 'monospace']
          },
          maxWidth: {
            article: '720px'
          }
        }
      }
    }
  </script>

  {{/* Custom styles */}}
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0a0a0a; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
    
    /* Selection */
    ::selection { background: #38bdf820; }
    
    /* Prose overrides for article content */
    .article-content h2 { font-size: 1.25rem; font-weight: 600; margin-top: 2.5rem; margin-bottom: 1rem; color: #e5e5e5; }
    .article-content h3 { font-size: 1.1rem; font-weight: 600; margin-top: 2rem; margin-bottom: 0.75rem; color: #e5e5e5; }
    .article-content p { margin-bottom: 1rem; line-height: 1.75; }
    .article-content ul { list-style: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
    .article-content li { margin-bottom: 0.5rem; line-height: 1.7; }
    .article-content a { color: #38bdf8; text-decoration: none; border-bottom: 1px solid transparent; transition: border-color 0.15s; }
    .article-content a:hover { border-bottom-color: #38bdf8; }
    .article-content strong { color: #e5e5e5; font-weight: 600; }
    .article-content hr { border: none; border-top: 1px solid rgba(255,255,255,0.06); margin: 2rem 0; }
    .article-content blockquote { border-left: 2px solid #38bdf8; padding-left: 1rem; color: #a3a3a3; margin: 1.5rem 0; }
    .article-content code { font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; background: #1a1a1a; padding: 0.15rem 0.4rem; border-radius: 3px; }
    .article-content pre { background: #111; border: 1px solid rgba(255,255,255,0.06); border-radius: 6px; padding: 1rem; overflow-x: auto; margin: 1.5rem 0; }
    .article-content pre code { background: none; padding: 0; }

    /* Light mode */
    html:not(.dark) { background: #fafafa; }
    html:not(.dark) .article-content h2,
    html:not(.dark) .article-content h3,
    html:not(.dark) .article-content strong { color: #171717; }
    html:not(.dark) .article-content code { background: #f0f0f0; }
    html:not(.dark) .article-content pre { background: #f5f5f5; border-color: #e5e5e5; }
  </style>

  {{ partial "extend_head.html" . }}
  
  {{/* RSS */}}
  {{ range .AlternativeOutputFormats }}
  <link rel="{{ .Rel }}" type="{{ .MediaType.Type }}" href="{{ .Permalink | safeURL }}">
  {{ end }}
</head>
<body class="dark:bg-bg bg-bg-light dark:text-fg-muted text-fg-light font-sans min-h-screen antialiased">
  
  {{ partial "header.html" . }}
  
  <main class="max-w-5xl mx-auto px-4 sm:px-6 py-8">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}

  {{/* Theme toggle */}}
  <script>
    const html = document.documentElement;
    const stored = localStorage.getItem('theme');
    if (stored === 'light') html.classList.remove('dark');
    else if (stored === 'dark' || !stored) html.classList.add('dark');
    
    function toggleTheme() {
      html.classList.toggle('dark');
      localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
    }
  </script>
</body>
</html>
