{{ define "main" }}
{{ $posts := where site.RegularPages "Section" "posts" }}
{{ $latest := first 1 $posts }}
{{ $recent := after 1 (first 7 $posts) }}
{{ $older := after 7 $posts }}

{{/* ===== Header line ===== */}}
<div class="flex items-baseline justify-between mb-5">
  <div>
    <h1 class="text-lg font-semibold tracking-tight" style="color: var(--fg);">{{ .Site.Title }}</h1>
    <p class="text-xs mt-0.5" style="color: var(--fg-muted);">{{ .Site.Params.description }}</p>
  </div>
  <span class="text-xs font-mono hidden sm:block" style="color: var(--fg-muted);">å…± {{ len $posts }} æœŸ</span>
</div>

{{/* ===== Grid: main + sidebar ===== */}}
<div class="grid grid-cols-1 lg:grid-cols-12 gap-5">

  {{/* ===== Main column (8/12) ===== */}}
  <div class="lg:col-span-8 space-y-4">

    {{/* Latest issue â€” featured card */}}
    {{ range $latest }}
    <a href="{{ .Permalink }}" class="card block p-5 group">
      <div class="flex items-center gap-2 mb-2">
        <span class="text-xs font-mono font-medium px-1.5 py-0.5 rounded" style="background: var(--primary); color: var(--primary-fg);">æœ€æ–°ä¸€æœŸ</span>
        <time class="text-xs font-mono" style="color: var(--fg-muted);" datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2006-01-02" }}</time>
      </div>
      <h2 class="text-base font-semibold leading-snug group-hover:text-primary transition-colors" style="color: var(--fg);">{{ .Title }}</h2>
      {{ with .Params.summary }}
      <p class="text-xs mt-2 leading-relaxed line-clamp-3" style="color: var(--fg-muted);">{{ . }}</p>
      {{ end }}
      {{ with .Params.tags }}
      <div class="flex flex-wrap gap-1 mt-3">
        {{ range first 5 . }}
        <span class="bg-tag text-xs font-mono px-1.5 py-0.5 rounded">{{ . }}</span>
        {{ end }}
      </div>
      {{ end }}
    </a>
    {{ end }}

    {{/* Recent issues â€” compact list inside card */}}
    {{ if $recent }}
    <div class="card">
      <div class="px-4 py-2.5 border-b" style="border-color: var(--border);">
        <h3 class="text-xs font-mono font-medium uppercase tracking-widest" style="color: var(--fg-muted);">è¿‘æœŸæ—¥æŠ¥</h3>
      </div>
      <div class="divide-y" style="border-color: var(--border);">
        {{ range $recent }}
        <a href="{{ .Permalink }}" class="flex items-center gap-3 px-4 py-2.5 group">
          <time class="text-xs font-mono shrink-0 w-14" style="color: var(--fg-muted);" datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "01-02" }}</time>
          <span class="text-sm font-medium truncate group-hover:text-primary transition-colors" style="color: var(--fg);">{{ .Title }}</span>
          {{ with .Params.tags }}
          <div class="hidden md:flex gap-1 shrink-0 ml-auto">
            {{ range first 2 . }}
            <span class="bg-tag text-xs font-mono px-1 py-0.5 rounded">{{ . }}</span>
            {{ end }}
          </div>
          {{ end }}
        </a>
        {{ end }}
      </div>
      {{ if $older }}
      <div class="px-4 py-2.5 border-t" style="border-color: var(--border);">
        <a href="{{ .Site.BaseURL }}archives/" class="text-xs font-mono hover:opacity-70 transition-opacity" style="color: var(--primary);">æŸ¥çœ‹å…¨éƒ¨ {{ len $posts }} æœŸ â†’</a>
      </div>
      {{ end }}
    </div>
    {{ end }}
  </div>

  {{/* ===== Sidebar (4/12) ===== */}}
  <div class="lg:col-span-4 space-y-4">

    {{/* About */}}
    <div class="card p-4">
      <h3 class="text-xs font-mono font-medium uppercase tracking-widest mb-2" style="color: var(--fg-muted);">å…³äº</h3>
      <p class="text-xs leading-relaxed" style="color: var(--fg-muted);">
        æ¯æ—¥è¿½è¸ª AI è¡Œä¸šåŠ¨æ€â€”â€”èèµ„ã€äº§å“ã€æŠ€æœ¯çªç ´ã€æ”¿ç­–å˜åŒ–ã€‚ç”± Manus AI ç”Ÿæˆï¼Œæ£® ç¼–è¾‘å®¡æ ¸ã€‚
      </p>
      <div class="flex gap-3 mt-3 text-xs font-mono">
        <a href="{{ .Site.BaseURL }}index.xml" class="hover:opacity-70 transition-opacity" style="color: var(--primary);">ğŸ“¡ RSS</a>
        <a href="{{ .Site.BaseURL }}archives/" class="hover:opacity-70 transition-opacity" style="color: var(--primary);">æ—¶é—´çº¿</a>
      </div>
    </div>

    {{/* Tags */}}
    {{ if .Site.Taxonomies.tags }}
    <div class="card p-4">
      <h3 class="text-xs font-mono font-medium uppercase tracking-widest mb-2" style="color: var(--fg-muted);">æ ‡ç­¾</h3>
      <div class="flex flex-wrap gap-1.5">
        {{ range .Site.Taxonomies.tags.ByCount }}
        <a href="{{ .Page.Permalink }}" class="bg-tag text-xs font-mono px-1.5 py-0.5 rounded hover:opacity-80 transition-opacity">
          {{ .Page.Title }}
        </a>
        {{ end }}
      </div>
    </div>
    {{ end }}

    {{/* Quick links / nav */}}
    <div class="card p-4">
      <h3 class="text-xs font-mono font-medium uppercase tracking-widest mb-2" style="color: var(--fg-muted);">æ¿å—è¯´æ˜</h3>
      <div class="space-y-1.5 text-xs" style="color: var(--fg-muted);">
        <div class="flex items-center gap-2"><span>âš¡</span><span>ä»Šæ—¥é€Ÿè§ˆ â€” 5 æ¡æ ¸å¿ƒæ–°é—»</span></div>
        <div class="flex items-center gap-2"><span>ğŸ“°</span><span>å¤´æ¡æ·±è¯» â€” å½“æ—¥æœ€é‡è¦äº‹ä»¶</span></div>
        <div class="flex items-center gap-2"><span>ğŸ”­</span><span>èµ›é“æ‰«æ â€” ç»†åˆ†é¢†åŸŸåŠ¨æ€</span></div>
        <div class="flex items-center gap-2"><span>ğŸ› ï¸</span><span>å·¥å…·é›·è¾¾ â€” æ–°å·¥å…·æ¨è</span></div>
        <div class="flex items-center gap-2"><span>ğŸ“Š</span><span>æ•°æ®çœ‹æ¿ â€” å…³é”®è¡Œä¸šæŒ‡æ ‡</span></div>
        <div class="flex items-center gap-2"><span>ğŸŒ²</span><span>æ£®è¯´ â€” ç¼–è€…ç‹¬å®¶è¯„è®º</span></div>
      </div>
    </div>
  </div>
</div>
{{ end }}
