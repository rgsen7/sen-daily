{{ define "main" }}
{{ $posts := where site.RegularPages "Section" "posts" }}
{{ $latest := first 1 $posts }}
{{ $recent := after 1 (first 7 $posts) }}
{{ $older := after 7 $posts }}

{{/* ===== Header ===== */}}
<div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3 mb-8">
  <div>
    <h1 class="text-3xl font-extrabold tracking-tight" style="color: var(--fg);">{{ .Site.Title }}</h1>
    <p class="text-base mt-1" style="color: var(--fg-muted);">{{ .Site.Params.description }}</p>
  </div>
  <div class="flex items-center gap-3">
    <span class="section-label">å…± {{ len $posts }} æœŸ</span>
    <a href="{{ .Site.BaseURL }}index.xml" class="text-sm font-medium hover:opacity-70 transition-opacity" style="color: var(--primary);">ğŸ“¡ RSS</a>
  </div>
</div>

{{/* ===== Grid ===== */}}
<div class="grid grid-cols-1 lg:grid-cols-12 gap-6">

  {{/* Main (8/12) */}}
  <div class="lg:col-span-8 space-y-5">

    {{/* Latest â€” featured */}}
    {{ range $latest }}
    <a href="{{ .Permalink }}" class="card card-featured block p-6 group">
      <div class="flex items-center gap-3 mb-3">
        <span class="text-xs font-mono font-bold px-2 py-1 rounded" style="background: var(--primary); color: var(--primary-fg);">æœ€æ–°ä¸€æœŸ</span>
        <time class="text-sm font-mono" style="color: var(--fg-muted);" datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2006-01-02" }}</time>
      </div>
      <h2 class="text-xl font-bold leading-snug group-hover:text-primary transition-colors" style="color: var(--fg);">{{ .Title }}</h2>
      {{ with .Params.summary }}
      <p class="text-sm mt-3 leading-relaxed line-clamp-3" style="color: var(--fg-muted);">{{ . }}</p>
      {{ end }}
      {{ with .Params.tags }}
      <div class="flex flex-wrap gap-1.5 mt-4">
        {{ range first 5 . }}
        <span class="bg-tag text-xs font-mono font-medium px-2 py-0.5 rounded">{{ . }}</span>
        {{ end }}
      </div>
      {{ end }}
    </a>
    {{ end }}

    {{/* Recent list */}}
    {{ if $recent }}
    <div class="card">
      <div class="px-5 py-3 border-b" style="border-color: var(--border);">
        <h3 class="section-label">å¾€æœŸæ—¥æŠ¥</h3>
      </div>
      <div class="divide-y" style="border-color: var(--border);">
        {{ range $recent }}
        <a href="{{ .Permalink }}" class="flex items-center gap-4 px-5 py-3.5 group">
          <time class="text-sm font-mono shrink-0 w-16" style="color: var(--fg-muted);" datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "01-02" }}</time>
          <span class="text-base font-medium truncate group-hover:text-primary transition-colors" style="color: var(--fg);">{{ .Title }}</span>
          {{ with .Params.tags }}
          <div class="hidden md:flex gap-1.5 shrink-0 ml-auto">
            {{ range first 2 . }}
            <span class="bg-tag text-xs font-mono px-1.5 py-0.5 rounded">{{ . }}</span>
            {{ end }}
          </div>
          {{ end }}
        </a>
        {{ end }}
      </div>
      {{ if $older }}
      <div class="px-5 py-3 border-t" style="border-color: var(--border);">
        <a href="{{ .Site.BaseURL }}archives/" class="text-sm font-medium hover:opacity-70 transition-opacity" style="color: var(--primary);">æŸ¥çœ‹å…¨éƒ¨ {{ len $posts }} æœŸ â†’</a>
      </div>
      {{ end }}
    </div>
    {{ end }}
  </div>

  {{/* Sidebar (4/12) */}}
  <div class="lg:col-span-4 space-y-5">

    {{/* About */}}
    <div class="card p-5">
      <h3 class="section-label mb-3">å…³äº</h3>
      <p class="text-sm leading-relaxed" style="color: var(--fg-muted);">
        æ¯æ—¥è¿½è¸ª AI è¡Œä¸šåŠ¨æ€â€”â€”èèµ„ã€äº§å“ã€æŠ€æœ¯çªç ´ã€æ”¿ç­–å˜åŒ–ã€‚ç”± Manus AI ç”Ÿæˆï¼Œæ£® ç¼–è¾‘å®¡æ ¸ã€‚
      </p>
      <div class="flex gap-4 mt-4">
        <a href="{{ .Site.BaseURL }}index.xml" class="text-sm font-medium hover:opacity-70 transition-opacity" style="color: var(--primary);">ğŸ“¡ RSS</a>
        <a href="{{ .Site.BaseURL }}archives/" class="text-sm font-medium hover:opacity-70 transition-opacity" style="color: var(--primary);">æ—¶é—´çº¿</a>
      </div>
    </div>

    {{/* Tags */}}
    {{ if .Site.Taxonomies.tags }}
    <div class="card p-5">
      <h3 class="section-label mb-3">æ ‡ç­¾</h3>
      <div class="flex flex-wrap gap-2">
        {{ range .Site.Taxonomies.tags.ByCount }}
        <a href="{{ .Page.Permalink }}" class="bg-tag text-sm font-mono px-2 py-0.5 rounded hover:opacity-80 transition-opacity">
          {{ .Page.Title }}
        </a>
        {{ end }}
      </div>
    </div>
    {{ end }}

    {{/* Sections guide */}}
    <div class="card p-5">
      <h3 class="section-label mb-3">æ¿å—è¯´æ˜</h3>
      <div class="space-y-2 text-sm" style="color: var(--fg-muted);">
        <div class="flex items-center gap-2.5"><span>âš¡</span><span>ä»Šæ—¥é€Ÿè§ˆ â€” 5 æ¡æ ¸å¿ƒæ–°é—»</span></div>
        <div class="flex items-center gap-2.5"><span>ğŸ“°</span><span>å¤´æ¡æ·±è¯» â€” å½“æ—¥æœ€é‡è¦äº‹ä»¶</span></div>
        <div class="flex items-center gap-2.5"><span>ğŸ”­</span><span>èµ›é“æ‰«æ â€” ç»†åˆ†é¢†åŸŸåŠ¨æ€</span></div>
        <div class="flex items-center gap-2.5"><span>ğŸ› ï¸</span><span>å·¥å…·é›·è¾¾ â€” æ–°å·¥å…·æ¨è</span></div>
        <div class="flex items-center gap-2.5"><span>ğŸ“Š</span><span>æ•°æ®çœ‹æ¿ â€” å…³é”®è¡Œä¸šæŒ‡æ ‡</span></div>
        <div class="flex items-center gap-2.5"><span>ğŸŒ²</span><span>æ£®è¯´ â€” ç¼–è€…ç‹¬å®¶è¯„è®º</span></div>
      </div>
    </div>
  </div>
</div>
{{ end }}
